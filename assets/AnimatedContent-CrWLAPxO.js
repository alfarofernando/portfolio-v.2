import{b as n,M as I,j as f,c as P,P as L,d as $,L as b,m as A}from"./index-BPJNS9W5.js";class S extends n.Component{getSnapshotBeforeUpdate(r){const t=this.props.childRef.current;if(t&&r.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function B({children:o,isPresent:r}){const t=n.useId(),s=n.useRef(null),p=n.useRef({width:0,height:0,top:0,left:0}),{nonce:C}=n.useContext(I);return n.useInsertionEffect(()=>{const{width:h,height:e,top:a,left:d}=p.current;if(r||!s.current||!h||!e)return;s.current.dataset.motionPopId=t;const l=document.createElement("style");return C&&(l.nonce=C),document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${e}px !important;
            top: ${a}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(l)}},[r]),f.jsx(S,{isPresent:r,childRef:s,sizeRef:p,children:n.cloneElement(o,{ref:s})})}const D=({children:o,initial:r,isPresent:t,onExitComplete:s,custom:p,presenceAffectsLayout:C,mode:h})=>{const e=P(K),a=n.useId(),d=n.useCallback(c=>{e.set(c,!0);for(const g of e.values())if(!g)return;s&&s()},[e,s]),l=n.useMemo(()=>({id:a,initial:r,isPresent:t,custom:p,onExitComplete:d,register:c=>(e.set(c,!1),()=>e.delete(c))}),C?[Math.random(),d]:[t,d]);return n.useMemo(()=>{e.forEach((c,g)=>e.set(g,!1))},[t]),n.useEffect(()=>{!t&&!e.size&&s&&s()},[t]),h==="popLayout"&&(o=f.jsx(B,{isPresent:t,children:o})),f.jsx(L.Provider,{value:l,children:o})};function K(){return new Map}const y=o=>o.key||"";function w(o){const r=[];return n.Children.forEach(o,t=>{n.isValidElement(t)&&r.push(t)}),r}const U=({children:o,exitBeforeEnter:r,custom:t,initial:s=!0,onExitComplete:p,presenceAffectsLayout:C=!0,mode:h="sync"})=>{const e=n.useMemo(()=>w(o),[o]),a=e.map(y),d=n.useRef(!0),l=n.useRef(e),c=P(()=>new Map),[g,z]=n.useState(e),[m,j]=n.useState(e);$(()=>{d.current=!1,l.current=e;for(let u=0;u<m.length;u++){const i=y(m[u]);a.includes(i)?c.delete(i):c.get(i)!==!0&&c.set(i,!1)}},[m,a.length,a.join("-")]);const E=[];if(e!==g){let u=[...e];for(let i=0;i<m.length;i++){const x=m[i],v=y(x);a.includes(v)||(u.splice(i,0,x),E.push(x))}h==="wait"&&E.length&&(u=E),j(w(u)),z(e);return}const{forceRender:R}=n.useContext(b);return f.jsx(f.Fragment,{children:m.map(u=>{const i=y(u),x=e===m||a.includes(i),v=()=>{if(c.has(i))c.set(i,!0);else return;let M=!0;c.forEach(k=>{k||(M=!1)}),M&&(R==null||R(),j(l.current),p&&p())};return f.jsx(D,{isPresent:x,initial:!d.current||s?void 0:!1,custom:x?void 0:t,presenceAffectsLayout:C,mode:h,onExitComplete:x?void 0:v,children:u},i)})})},G=({children:o,keyProp:r})=>f.jsx(U,{mode:"wait",children:f.jsx(A.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.5},children:o},r)});export{G as A,U as a};
